<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>留言板</title>
    <style>
        #box {
            width: 400px;
            height: 100px;
            border: 1px solid #a74343;
            padding: 10px;
            margin: 10px;
        }

        #box textarea {
            width: 100%;
            height: 80%;
        }

        #box p {
            text-align: right;
            margin: 0;
            font-size: 12px;
        }

    </style>
</head>

<body>
<div id="box">
    <textarea id="liuyan" name="msg"></textarea>
    <p>还可以输入<span id="msg">10</span>个字</p>
</div>
</body>
</html>



<script>
    var isInputting = false;
    var liuyanEl = document.getElementById("liuyan");
    var msgEl = document.getElementById("msg");
    const maxLen = parseInt(msgEl.innerText);


    //判断开始输入的是否是中文
    liuyanEl.addEventListener("compositionstart",function () {
        isInputting = true;
    });
    liuyanEl.addEventListener("compositionupdate",function () {
        isInputting = true;
    });
    liuyanEl.addEventListener("compositionend",function () {
        isInputting = false;
    });

    function doFunc(){
        if (!isInputting) {
            console.log(liuyanEl.value.length);
            msgEl.innerText=10-liuyanEl.value.length;
            if(parseInt(msgEl.innerText)<0){
                alert("超出字数范围！！！");
                 msgEl.innerText=0;
                liuyanEl.value=liuyanEl.value.substring(0,maxLen);
            }
        }
    }

    liuyanEl.addEventListener("keyup",doFunc);
    liuyanEl.addEventListener("click",doFunc);
</script>